(function(k,S){typeof exports=="object"&&typeof module<"u"?S(exports):typeof define=="function"&&define.amd?define(["exports"],S):(k=typeof globalThis<"u"?globalThis:k||self,S(k.minical={}))})(this,function(k){"use strict";var ht=Object.defineProperty;var ft=(k,S,H)=>S in k?ht(k,S,{enumerable:!0,configurable:!0,writable:!0,value:H}):k[S]=H;var v=(k,S,H)=>ft(k,typeof S!="symbol"?S+"":S,H);var S=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}var X={exports:{}};(function($,a){(function(r,s){$.exports=s()})(S,function(){var r=1e3,s=6e4,f=36e5,l="millisecond",p="second",b="minute",M="hour",g="day",B="week",m="month",N="quarter",C="year",_="date",I="Invalid Date",j=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,J=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,z={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(o){var n=["th","st","nd","rd"],t=o%100;return"["+o+(n[(t-20)%10]||n[t]||n[0])+"]"}},K=function(o,n,t){var i=String(o);return!i||i.length>=n?o:""+Array(n+1-i.length).join(t)+o},dt={s:K,z:function(o){var n=-o.utcOffset(),t=Math.abs(n),i=Math.floor(t/60),e=t%60;return(n<=0?"+":"-")+K(i,2,"0")+":"+K(e,2,"0")},m:function o(n,t){if(n.date()<t.date())return-o(t,n);var i=12*(t.year()-n.year())+(t.month()-n.month()),e=n.clone().add(i,m),c=t-e<0,u=n.clone().add(i+(c?-1:1),m);return+(-(i+(t-e)/(c?e-u:u-e))||0)},a:function(o){return o<0?Math.ceil(o)||0:Math.floor(o)},p:function(o){return{M:m,y:C,w:B,d:g,D:_,h:M,m:b,s:p,ms:l,Q:N}[o]||String(o||"").toLowerCase().replace(/s$/,"")},u:function(o){return o===void 0}},P="en",Y={};Y[P]=z;var it="$isDayjsObject",R=function(o){return o instanceof G||!(!o||!o[it])},q=function o(n,t,i){var e;if(!n)return P;if(typeof n=="string"){var c=n.toLowerCase();Y[c]&&(e=c),t&&(Y[c]=t,e=c);var u=n.split("-");if(!e&&u.length>1)return o(u[0])}else{var h=n.name;Y[h]=n,e=h}return!i&&e&&(P=e),e||!i&&P},D=function(o,n){if(R(o))return o.clone();var t=typeof n=="object"?n:{};return t.date=o,t.args=arguments,new G(t)},d=dt;d.l=q,d.i=R,d.w=function(o,n){return D(o,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var G=function(){function o(t){this.$L=q(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[it]=!0}var n=o.prototype;return n.parse=function(t){this.$d=function(i){var e=i.date,c=i.utc;if(e===null)return new Date(NaN);if(d.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var u=e.match(j);if(u){var h=u[2]-1||0,y=(u[7]||"0").substring(0,3);return c?new Date(Date.UTC(u[1],h,u[3]||1,u[4]||0,u[5]||0,u[6]||0,y)):new Date(u[1],h,u[3]||1,u[4]||0,u[5]||0,u[6]||0,y)}}return new Date(e)}(t),this.init()},n.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},n.$utils=function(){return d},n.isValid=function(){return this.$d.toString()!==I},n.isSame=function(t,i){var e=D(t);return this.startOf(i)<=e&&e<=this.endOf(i)},n.isAfter=function(t,i){return D(t)<this.startOf(i)},n.isBefore=function(t,i){return this.endOf(i)<D(t)},n.$g=function(t,i,e){return d.u(t)?this[i]:this.set(e,t)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(t,i){var e=this,c=!!d.u(i)||i,u=d.p(t),h=function(F,O){var A=d.w(e.$u?Date.UTC(e.$y,O,F):new Date(e.$y,O,F),e);return c?A:A.endOf(g)},y=function(F,O){return d.w(e.toDate()[F].apply(e.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(O)),e)},E=this.$W,w=this.$M,L=this.$D,U="set"+(this.$u?"UTC":"");switch(u){case C:return c?h(1,0):h(31,11);case m:return c?h(1,w):h(0,w+1);case B:var W=this.$locale().weekStart||0,V=(E<W?E+7:E)-W;return h(c?L-V:L+(6-V),w);case g:case _:return y(U+"Hours",0);case M:return y(U+"Minutes",1);case b:return y(U+"Seconds",2);case p:return y(U+"Milliseconds",3);default:return this.clone()}},n.endOf=function(t){return this.startOf(t,!1)},n.$set=function(t,i){var e,c=d.p(t),u="set"+(this.$u?"UTC":""),h=(e={},e[g]=u+"Date",e[_]=u+"Date",e[m]=u+"Month",e[C]=u+"FullYear",e[M]=u+"Hours",e[b]=u+"Minutes",e[p]=u+"Seconds",e[l]=u+"Milliseconds",e)[c],y=c===g?this.$D+(i-this.$W):i;if(c===m||c===C){var E=this.clone().set(_,1);E.$d[h](y),E.init(),this.$d=E.set(_,Math.min(this.$D,E.daysInMonth())).$d}else h&&this.$d[h](y);return this.init(),this},n.set=function(t,i){return this.clone().$set(t,i)},n.get=function(t){return this[d.p(t)]()},n.add=function(t,i){var e,c=this;t=Number(t);var u=d.p(i),h=function(w){var L=D(c);return d.w(L.date(L.date()+Math.round(w*t)),c)};if(u===m)return this.set(m,this.$M+t);if(u===C)return this.set(C,this.$y+t);if(u===g)return h(1);if(u===B)return h(7);var y=(e={},e[b]=s,e[M]=f,e[p]=r,e)[u]||1,E=this.$d.getTime()+t*y;return d.w(E,this)},n.subtract=function(t,i){return this.add(-1*t,i)},n.format=function(t){var i=this,e=this.$locale();if(!this.isValid())return e.invalidDate||I;var c=t||"YYYY-MM-DDTHH:mm:ssZ",u=d.z(this),h=this.$H,y=this.$m,E=this.$M,w=e.weekdays,L=e.months,U=e.meridiem,W=function(O,A,Z,Q){return O&&(O[A]||O(i,c))||Z[A].slice(0,Q)},V=function(O){return d.s(h%12||12,O,"0")},F=U||function(O,A,Z){var Q=O<12?"AM":"PM";return Z?Q.toLowerCase():Q};return c.replace(J,function(O,A){return A||function(Z){switch(Z){case"YY":return String(i.$y).slice(-2);case"YYYY":return d.s(i.$y,4,"0");case"M":return E+1;case"MM":return d.s(E+1,2,"0");case"MMM":return W(e.monthsShort,E,L,3);case"MMMM":return W(L,E);case"D":return i.$D;case"DD":return d.s(i.$D,2,"0");case"d":return String(i.$W);case"dd":return W(e.weekdaysMin,i.$W,w,2);case"ddd":return W(e.weekdaysShort,i.$W,w,3);case"dddd":return w[i.$W];case"H":return String(h);case"HH":return d.s(h,2,"0");case"h":return V(1);case"hh":return V(2);case"a":return F(h,y,!0);case"A":return F(h,y,!1);case"m":return String(y);case"mm":return d.s(y,2,"0");case"s":return String(i.$s);case"ss":return d.s(i.$s,2,"0");case"SSS":return d.s(i.$ms,3,"0");case"Z":return u}return null}(O)||u.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(t,i,e){var c,u=this,h=d.p(i),y=D(t),E=(y.utcOffset()-this.utcOffset())*s,w=this-y,L=function(){return d.m(u,y)};switch(h){case C:c=L()/12;break;case m:c=L();break;case N:c=L()/3;break;case B:c=(w-E)/6048e5;break;case g:c=(w-E)/864e5;break;case M:c=w/f;break;case b:c=w/s;break;case p:c=w/r;break;default:c=w}return e?c:d.a(c)},n.daysInMonth=function(){return this.endOf(m).$D},n.$locale=function(){return Y[this.$L]},n.locale=function(t,i){if(!t)return this.$L;var e=this.clone(),c=q(t,i,!0);return c&&(e.$L=c),e},n.clone=function(){return d.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},o}(),at=G.prototype;return D.prototype=at,[["$ms",l],["$s",p],["$m",b],["$H",M],["$W",g],["$M",m],["$y",C],["$D",_]].forEach(function(o){at[o[1]]=function(n){return this.$g(n,o[0],o[1])}}),D.extend=function(o,n){return o.$i||(o(n,G,D),o.$i=!0),D},D.locale=q,D.isDayjs=R,D.unix=function(o){return D(1e3*o)},D.en=Y[P],D.Ls=Y,D.p={},D})})(X);var rt=X.exports;const x=H(rt);var tt={exports:{}};(function($,a){(function(r,s){$.exports=s()})(S,function(){return function(r,s,f){s.prototype.isToday=function(){var l="YYYY-MM-DD",p=f();return this.format(l)===p.format(l)}}})})(tt);var ot=tt.exports;const ct=H(ot);function T($,a,r){const s=document.createElement($);typeof a=="string"&&(a={cls:a});const f=a||{},{cls:l,text:p,attr:b,title:M,value:g,placeholder:B,type:m,parent:N,prepend:C,href:_,...I}=f;if(l&&(s.className=Array.isArray(l)?l.join(" "):l),p&&(s.textContent=p),b)for(const[j,J]of Object.entries(b))s.setAttribute(j,J);M!==void 0&&(s.title=M),g!==void 0&&(s instanceof HTMLInputElement||s instanceof HTMLSelectElement||s instanceof HTMLOptionElement)&&(s.value=g),B&&s instanceof HTMLInputElement&&(s.placeholder=B),m&&(s instanceof HTMLInputElement?s.type=m:s instanceof HTMLStyleElement&&s.setAttribute("type",m)),_&&(s instanceof HTMLAnchorElement||s instanceof HTMLLinkElement||s instanceof HTMLBaseElement)&&(s.href=_),N&&(C?N.insertBefore(s,N.firstChild):N.appendChild(s));for(const j in I)if(Object.prototype.hasOwnProperty.call(I,j)&&j.startsWith("on")){const J=j.substring(2),z=I[j];typeof z=="function"&&s.addEventListener(J,z)}return s}function et($){return $ instanceof Date&&!isNaN($.getTime())}function nt($){const a=new Date($);return!isNaN(a.getTime())}x.extend(ct);const st={targetEl:document.body,initMonth:new Date,events:[],theme:null,startOfWeek:0,allowNavigation:!0,displayNavButtons:!0,onDateClick:void 0},ut={monthchange:!0};class lt{constructor(a){v(this,"events",[]);v(this,"options");v(this,"initialDate");v(this,"displayDate");v(this,"customEventTypes",Object.keys(ut));v(this,"wrapperEl",T("div",{cls:["wrapper","minical"]}));v(this,"calBodyEl",T("div",{cls:"minical-body"}));v(this,"headerEl",T("div",{cls:"minical-header"}));v(this,"headerSpan",T("span"));v(this,"weekdayEls",new Array(7).fill("").map(a=>T("div",{cls:"weekday"})));v(this,"weekdaySpans",new Array(7).fill("").map(()=>T("span",{cls:"weekday-title"})));v(this,"dayEls",new Array(42).fill("").map((a,r)=>T("div",{cls:["mc-day",r>35?"overflow":""].filter(s=>s)})));v(this,"daySpans",new Array(42).fill("").map(()=>T("span")));v(this,"dayDotContainers",new Array(42).fill("").map(()=>T("div",{cls:["mc-event-dot-container"]})));v(this,"targetEl");v(this,"navContainer",T("div",{cls:["mc-nav","container"]}));v(this,"nextMonthButton",T("button",{cls:["mc-nav","mc-next-month"]}));v(this,"prevMonthButton",T("button",{cls:["mc-nav","mc-prev-month"]}));v(this,"resetDateButton",T("button",{cls:["mc-nav","mc-reset-date"]}));v(this,"_dayElDateMap",new Map);a??(a={...st});const r={...st,...a};this.initialDate=r.initMonth,this.displayDate=this.initialDate,this.targetEl=r.targetEl,this.options={...r},this.options.events.length&&this.setEvents(this.options.events),this.setup()}setup(){return this.headerEl.append(this.headerSpan),this.options.allowNavigation&&this.options.displayNavButtons&&(this.navContainer.append(this.prevMonthButton,this.resetDateButton,this.nextMonthButton),this.headerEl.append(this.navContainer),this.initNavButtonConfigs()),this.addWeekdayNames(),this.weekdayEls.forEach((a,r)=>{const s=this.weekdaySpans[r];a.append(s)}),this.dayEls.forEach((a,r)=>{const s=this.daySpans[r],f=this.dayDotContainers[r];a.append(s,f)}),this.calBodyEl.append(...this.weekdayEls,...this.dayEls),this.wrapperEl.append(this.headerEl,this.calBodyEl),this.setDayNums().updateMonthTitle().initMinicalEventListener().initCalBodyClickListener(),this}get _displayDate(){return x(this.displayDate)}get startOfMonth(){return this._displayDate.startOf("month")}get endOfMonth(){return this._displayDate.endOf("month")}setDayNums(){const a=this.startOfMonth.day(),r=this.daySpans.slice(0,a),s=this.startOfMonth.daysInMonth(),f=this.daySpans.slice(a,a+s),l=this.daySpans.slice(a+s);[...r,...l].forEach(b=>{b.innerText="";const M=b.parentElement;M.classList.add("outside-month"),M.classList.remove("in-month","today"),M.querySelector(".mc-event-dot-container").replaceChildren(),this._dayElDateMap.set(M,null)});const p=this.getFilteredEventsForMonth();return f.forEach((b,M)=>{const g=this.startOfMonth.add(M,"day");b.innerText=`${M+1}`;const B=p.filter(_=>x(_.date).isSame(g,"date")),m=b.parentElement;this._dayElDateMap.set(m,g),m.classList.remove("outside-month"),m.classList.add("in-month"),m.classList.toggle("today",g.isToday());const N=this.dayDotContainers[a+M],C=B.map(_=>T("span",{cls:["mc-event-dot"]}));N.replaceChildren(...C)}),this.calBodyEl.classList.toggle("show-overflow",a+s>35),this}addWeekdayNames(){this.weekdaySpans.forEach((a,r)=>{const f=x().set("day",r).format("dd");a.innerText=f})}updateMonthTitle(){return this.headerSpan.innerText=this._displayDate.format("MMMM YY"),this}addToDom(){this.targetEl.append(this.wrapperEl)}nextMonth(){this.options.allowNavigation&&(this.displayDate=this.startOfMonth.add(1,"month").toDate(),this.dispatchMinicalEvent("monthchange"))}previousMonth(){this.options.allowNavigation&&(this.displayDate=this.startOfMonth.subtract(1,"month").toDate(),this.dispatchMinicalEvent("monthchange"))}resetDateToToday(){const a=x(),r=this._displayDate.isSame(a,"month");this.displayDate=a.toDate(),r||this.dispatchMinicalEvent("monthchange")}dispatchMinicalEvent(a,r){const s=new CustomEvent(`minical-${a}`,{bubbles:!0,detail:r});return this.wrapperEl.dispatchEvent(s),s}initMinicalEventListener(){return this.customEventTypes.map(r=>`minical-${r}`).forEach(r=>{this.wrapperEl.addEventListener(r,this.handleMinicalEvents.bind(this))}),this}initNavButtonConfigs(){return!this.options.allowNavigation||!this.options.displayNavButtons?void 0:([{btn:this.prevMonthButton,cb:this.previousMonth},{btn:this.nextMonthButton,cb:this.nextMonth},{btn:this.resetDateButton,cb:this.resetDateToToday}].forEach(r=>{const{btn:s,cb:f}=r;s.addEventListener("click",f.bind(this))}),this)}handleCalBodyClickEvents(a){const{target:r}=a,s=r,f=this.dayEls.find(l=>l.contains(s));if(f){const l=this._dayElDateMap.get(f);if(l!=null&&x.isDayjs(l)){const p=this.getFilteredEventsForDay(l);this.options.onDateClick&&this.options.onDateClick(l,p,a)}}}initCalBodyClickListener(){return this.calBodyEl.addEventListener("click",this.handleCalBodyClickEvents.bind(this)),this}handleMinicalEvents(a){const r=a.type.replace(/^minical-/,"");if(this.customEventTypes.includes(r))switch(r){case"monthchange":this.setDayNums().updateMonthTitle();break}}getFilteredEventsForMonth(){return this.events.filter(a=>{const r=x(a.date);return this._displayDate.isSame(r,"month")})}getFilteredEventsForDay(a){const r=x(a);return this.events.filter(s=>{const f=x(s.date);return r.isSame(f,"date")})}setEvents(a){if(!Array.isArray(a))throw new Error(`must be an array of events. received type ${typeof a}`);const r=[...a],s=[],f=r.filter(l=>Object.hasOwn(l,"date")?et(l.date)?!0:nt(l.date)?(l.date=new Date(l.date),!0):(s.push(l),!1):(s.push(l),!1));s.length&&console.warn("some events were filtered out because of invalid data type",s),this.events=f}addEvents(a){if(!Array.isArray(a))throw new Error(`must be an array of events. received type ${typeof a}`);const r=[...a],s=[],f=r.filter(p=>Object.hasOwn(p,"date")?et(p.date)?!0:nt(p.date)?(p.date=new Date(p.date),!0):(s.push(p),!1):(s.push(p),!1));s.length&&console.warn("some events were filtered out because of invalid data type",s);const l=[...new Set([...this.events,...f])];this.events=l}}k.MiniCal=lt,Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})});
